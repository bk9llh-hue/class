<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Animated Smart Browser</title>

<!-- Google Fonts & Material Icons -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body, html { height: 100%; font-family: 'Poppins', sans-serif; background: #121212; display: flex; flex-direction: column; overflow: hidden; }

/* Top Bar */
.top-bar { width: 100%; background: #2b2b2b; display: flex; flex-direction: column; padding-top: 6px; }

/* Tabs */
.tabs { display: flex; align-items: flex-end; height: 36px; padding-left: 8px; gap: 4px; overflow-x: auto; user-select: none; }
.tabs::-webkit-scrollbar { display: none; }

.tab {
  display: flex; align-items: center; height: 32px; min-width: 120px; padding: 0 8px; background: #3a3a3a; cursor: pointer;
  position: relative; border-top-left-radius: 8px; border-top-right-radius: 8px;
  clip-path: polygon(6px 0, 100% 0, 100% 100%, 0 100%, 0 6px);
  flex-shrink: 0; opacity: 0; transform: translateX(20px); transition: all 0.25s ease;
}
.tab.show { opacity: 1; transform: translateX(0); }

.tab.active { background: #1a73e8; z-index: 2; box-shadow: 0 6px 12px rgba(0,0,0,0.3); transition: all 0.3s ease; }
.tab:hover:not(.active) { background: #4f4f4f; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }

.tab img.favicon { width: 16px; height: 16px; margin-right: 6px; border-radius: 3px; }
.tab span.title { font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: #fff; }
.tab .close { display: flex; justify-content: center; align-items: center; font-size: 14px; width: 20px; height: 20px; line-height: 18px;
    text-align: center; border-radius: 50%; cursor: pointer; transition: background 0.2s, transform 0.2s; margin-left: auto; color: #ccc; }
.tab:hover .close { display: flex; }
.tab .close:hover { background: rgba(0,0,0,0.1); transform: scale(1.1); }

/* New Tab Button */
.new-tab-btn { width: 20px; height: 20px; border-radius: 50%; background: #3a3a3a; border: none; cursor: pointer;
  font-size: 14px; display: flex; justify-content: center; align-items: center; flex-shrink: 0; margin-left: 2px;
  transition: background 0.2s, transform 0.25s; color: #fff; position: relative; top: -10px; }
.new-tab-btn:hover { background: #1a73e8; transform: translateY(-3px); }
.new-tab-btn span.material-icons { font-size: 14px; line-height: 20px; position: relative; top: -1px; }

/* URL Bar */
.urlbar-row { display: flex; align-items: center; padding: 4px 8px; background: #3a3a3a; gap: 8px; }
.nav-btn, .menu-btn { font-size: 20px; cursor: pointer; color: #ccc; display: flex; align-items: center; justify-content: center;
    width: 36px; height: 36px; border-radius: 6px; transition: all 0.2s; }
.nav-btn:hover, .menu-btn:hover { background: #4a4a4a; color: white; }
.nav-btn.disabled { opacity: 0.3; pointer-events: none; }

.urlbar { flex: 1; display: flex; align-items: center; background: #2b2b2b; border-radius: 16px; height: 32px; padding: 0 8px;
    position: relative; transition: all 0.2s; }
.urlbar:hover { background: #3a3a3a; }
.urlbar input { flex: 1; border: none; outline: none; background: transparent; font-size: 14px; color: white; padding-left: 4px; }
.urlbar img { width: 18px; height: 18px; margin-right: 4px; }

/* Iframe */
#iframe-container { flex: 1; background: #000; }
#iframe-container iframe { width: 100%; height: 100%; border: none; transition: opacity 0.3s ease; }
</style>
</head>
<body>

<div class="top-bar">
  <div class="tabs" id="tabs"></div>
  <div class="urlbar-row">
      <span class="nav-btn material-icons disabled" id="back">arrow_back</span>
      <span class="nav-btn material-icons disabled" id="forward">arrow_forward</span>
      <span class="nav-btn material-icons" id="reload">refresh</span>

      <div class="urlbar">
          <img src="https://www.google.com/s2/favicons?domain=google.com" />
          <input id="urlInput" placeholder="Search or enter a URL" />
      </div>

      <span class="menu-btn material-icons">more_vert</span>
  </div>
</div>

<div id="iframe-container">
  <iframe id="viewer"></iframe>
</div>

<script>
const proxyBase = "https://YOUR_RENDER_APP_URL"; // your proxy
let tabs = [], currentTabId = null;

const tabContainer = document.getElementById('tabs');
const urlInput = document.getElementById('urlInput');
const viewer = document.getElementById('viewer');

function createTab(name="New Tab", url="https://example.com") {
    const id = Date.now();
    const tab = { id, name, url, history: [url], historyIndex: 0 };
    tabs.push(tab);
    renderTabs(true);
    setActiveTab(id);
}

function closeTab(id) {
    const index = tabs.findIndex(t=>t.id===id);
    if(index===-1) return;

    const el = document.querySelector(`.tab[data-id='${id}']`);
    if(el){
        el.style.transition="all 0.25s ease";
        el.style.transform="scaleX(0.3)";
        el.style.opacity="0";
        setTimeout(()=>{
            tabs.splice(index,1);
            renderTabs();
            if(currentTabId===id && tabs.length) setActiveTab(tabs[0].id);
        },250);
    }
}

function setActiveTab(id){
    currentTabId=id;
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    const el=document.querySelector(`.tab[data-id='${id}']`);
    if(el) el.classList.add('active');

    const tab = tabs.find(t=>t.id===id);
    if(tab){
        urlInput.value = tab.history[tab.historyIndex];
        loadTabUrl(tab);
        updateNavButtons(tab);
    }
}

function loadTabUrl(tab){
    viewer.style.opacity=0;
    setTimeout(()=>{
        viewer.src = `${proxyBase}/proxy?url=${encodeURIComponent(tab.history[tab.historyIndex])}`;
        viewer.onload=()=>viewer.style.opacity=1;
    },150);
}

function renderTabs(animated=false){
    tabContainer.innerHTML='';
    tabs.forEach(tab=>{
        const el = document.createElement('div');
        el.className='tab show';
        el.setAttribute('data-id',tab.id);
        el.innerHTML=`<img class="favicon" src="https://www.google.com/s2/favicons?domain=${tab.url}" /><span class="title">${tab.name}</span><span class="close" onclick="closeTab(${tab.id})">Ã—</span>`;
        el.onclick = ()=>setActiveTab(tab.id);
        if(animated){
            el.style.opacity=0; el.style.transform="translateX(20px)";
            setTimeout(()=>{ el.style.opacity=1; el.style.transform="translateX(0)"; },50);
        }
        tabContainer.appendChild(el);
    });

    const newBtn=document.createElement('button');
    newBtn.className='new-tab-btn';
    newBtn.innerHTML='<span class="material-icons">add</span>';
    newBtn.onclick=()=>createTab();
    tabContainer.appendChild(newBtn);
}

function loadSite(){
    let url=urlInput.value.trim();
    if(!url) return;
    if(!url.startsWith('http')) url='https://'+url;

    const tab = tabs.find(t=>t.id===currentTabId);
    if(tab){
        tab.history = tab.history.slice(0,tab.historyIndex+1);
        tab.history.push(url);
        tab.historyIndex=tab.history.length-1;
        setActiveTab(currentTabId);
    }
}

function updateNavButtons(tab){
    document.getElementById('back').classList.toggle('disabled', tab.historyIndex<=0);
    document.getElementById('forward').classList.toggle('disabled', tab.historyIndex>=tab.history.length-1);
}

// Navigation buttons
document.getElementById('back').addEventListener('click', ()=>{
    const tab=tabs.find(t=>t.id===currentTabId);
    if(tab && tab.historyIndex>0){ tab.historyIndex--; setActiveTab(tab.id); }
});
document.getElementById('forward').addEventListener('click', ()=>{
    const tab=tabs.find(t=>t.id===currentTabId);
    if(tab && tab.historyIndex<tab.history.length-1){ tab.historyIndex++; setActiveTab(tab.id); }
});
document.getElementById('reload').addEventListener('click', ()=>{
    const tab=tabs.find(t=>t.id===currentTabId);
    if(tab) loadTabUrl(tab);
});

urlInput.addEventListener('keydown', e=>{ if(e.key==='Enter') loadSite(); });

// Init
createTab("New Tab","https://example.com");
</script>

</body>
</html>
